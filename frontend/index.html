<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HomeShield AI Frontend</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    textarea, input { width: 100%; margin: 0.5rem 0; padding: 0.5rem; }
    button { margin: 0.5rem 0; padding: 0.5rem 1rem; cursor: pointer; }
    pre { background: #f4f4f4; padding: 1rem; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>üè† HomeShield AI</h1>

  <h2>Reindex Policies</h2>
  <button onclick="reindex()">Reindex</button>
  <pre id="reindex-result"></pre>

  <h2>Ask Coverage</h2>
  <input id="qa-customer" placeholder="Customer ID (e.g. C00001)" value="C00001">
  <input id="qa-plan" placeholder="Plan (e.g. Gold)" value="Gold">
  <input id="qa-state" placeholder="State (e.g. PA)" value="PA">
  <input id="qa-year" placeholder="Year (e.g. 2025)" value="2025">
  <textarea id="qa-question" placeholder="Ask your question...">Is the HVAC compressor covered?</textarea>
  <button onclick="askCoverage()">Ask /qa</button>
  <pre id="qa-result"></pre>

  <h2>Submit Claim</h2>
  <input id="claim-customer" placeholder="Customer ID (e.g. C00001)" value="C00001">
  <textarea id="claim-message" placeholder="Describe your issue...">My AC stopped cooling yesterday, thermostat shows E1.</textarea>
  <button onclick="submitClaim()">Submit /claim</button>
  <pre id="claim-result"></pre>

  <script>
    const API_URL = "http://localhost:8000";

    async function reindex() {
      const res = await fetch(`${API_URL}/reindex`, { method: "POST" });
      document.getElementById("reindex-result").innerText = JSON.stringify(await res.json(), null, 2);
    }

    async function askCoverage() {
      const body = {
        customer_id: document.getElementById("qa-customer").value,
        plan: document.getElementById("qa-plan").value,
        state: document.getElementById("qa-state").value,
        year: parseInt(document.getElementById("qa-year").value),
        question: document.getElementById("qa-question").value
      };
      const res = await fetch(`${API_URL}/qa`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body)
      });
      document.getElementById("qa-result").innerText = JSON.stringify(await res.json(), null, 2);
    }

    async function submitClaim() {
      const body = {
        customer_id: document.getElementById("claim-customer").value,
        message: document.getElementById("claim-message").value
      };
      const res = await fetch(`${API_URL}/claim`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body)
      });
      document.getElementById("claim-result").innerText = JSON.stringify(await res.json(), null, 2);
    }
  </script>
</body>
</html>
